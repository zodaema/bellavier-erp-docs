# Task 11 ‚Äì Work Queue Start & Details Patch

**Type:** Patch / Bugfix  
**Related:**  
- Work Queue UI (`index.php?p=work_queue`) ‚Äì Kanban/List  
- Token Start API (DAG_400_START_FAILED)  

---

## üéØ Objective

‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ **Work Queue** ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

1. ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° **‚Äú‡πÄ‡∏£‡∏¥‡πà‡∏°‚Äù** ‡∏ó‡∏µ‡πà‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô error:

   ```json
   {
     "ok": false,
     "error": "Token not available (status: ready)",
     "app_code": "DAG_400_START_FAILED"
   }

‡∏ó‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà token ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‚Äú‡∏û‡∏£‡πâ‡∏≠‡∏°‚Äù (status = 'ready') ‡πÅ‡∏•‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô Work Queue ‡∏Ç‡∏≠‡∏á operator ‡∏Ñ‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
	2.	‡πÅ‡∏ñ‡∏ö ‚Äú‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‚Äù ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà Work Queue ‡πÄ‡∏Ñ‡∏¢‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÄ‡∏ä‡πà‡∏ô serial / ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢ / note) ‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß (‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤)
	3.	‡πÅ‡∏Å‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ logic + data mapping ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏Å‡πâ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå / layout / styling ‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ Work Queue ‡∏ó‡∏±‡πâ‡∏á desktop + mobile

‚∏ª

üß± Scope & Constraints

‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÑ‡∏ß‡πâ (‡∏≠‡∏¢‡πà‡∏≤‡πÑ‡∏õ‡∏¢‡∏∏‡πà‡∏á)
	‚Ä¢	UI layout ‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ work_queue ‡∏ó‡∏±‡πâ‡∏á:
	‚Ä¢	Header ‚ÄúWork Queue‚Äù
	‚Ä¢	toggle Hide Scrapped Tokens, ‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô (my work)
	‚Ä¢	Dropdown All Nodes
	‚Ä¢	‡∏õ‡∏∏‡πà‡∏° Kanban / List / Refresh
	‚Ä¢	‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏á‡∏≤‡∏ô (job card) ‡∏ó‡∏±‡πâ‡∏á desktop ‡πÅ‡∏•‡∏∞ mobile
	‚Ä¢	‡∏ä‡∏∏‡∏î‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Task 9‚Äì10 ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö:
	‚Ä¢	SerialHealthService
	‚Ä¢	Serial Enforcement Stage 2
	‚Ä¢	Operator Availability (FF_HAT_ENFORCE_AVAILABILITY, hatthasilpa_operator_api.php)
	‚Ä¢	‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠ route / page key work_queue

‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ï‡∏∞‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô ‡πÉ‡∏´‡πâ‡πÅ‡∏Å‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö ‚Äústart token‚Äù ‡πÅ‡∏•‡∏∞ ‚Äúdata ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô card details‚Äù

Files (‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£ ‚Äì ‡πÉ‡∏´‡πâ Agent ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô repo)

Agent ‡∏Ñ‡∏ß‡∏£‡πÉ‡∏ä‡πâ text search ‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤:
	1.	Token Start API / Service
	‚Ä¢	‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ string:
	‚Ä¢	"Token not available (status:"
	‚Ä¢	"DAG_400_START_FAILED"
	‚Ä¢	‡∏ô‡πà‡∏≤‡∏à‡∏∞‡∏û‡∏ö‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå API/controller ‡πÄ‡∏ä‡πà‡∏ô source/hatthasilpa_token_api.php ‡∏´‡∏£‡∏∑‡∏≠ service class ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö token/job
	2.	Work Queue View + JS
	‚Ä¢	index.php route work_queue
	‚Ä¢	View: views/work_queue_*.php ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏Å‡∏•‡πâ‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á
	‚Ä¢	JS: assets/javascripts/hatthasilpa/work_queue.js ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡πâ‡∏≤‡∏¢‡∏Å‡∏±‡∏ô
	‚Ä¢	‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏° ‚Äú‡πÄ‡∏£‡∏¥‡πà‡∏°‚Äù bind event ‡∏Å‡∏±‡∏ö API ‡πÑ‡∏´‡∏ô, payload ‡∏≠‡∏∞‡πÑ‡∏£, ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô ‚Äú‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‚Äù ‡∏≠‡πà‡∏≤‡∏ô field ‡∏≠‡∏∞‡πÑ‡∏£‡∏à‡∏≤‡∏Å JSON

‚∏ª

üîß Part A ‚Äì Fix Start Token Logic (status: ready)

‡∏õ‡∏±‡∏ç‡∏´‡∏≤

‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î ‚Äú‡πÄ‡∏£‡∏¥‡πà‡∏°‚Äù token ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ Work Queue (‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á ‚Äú‡∏û‡∏£‡πâ‡∏≠‡∏°‚Äù):
	‚Ä¢	Request ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Start API ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏î‡πâ response DAG_400_START_FAILED ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Token not available (status: ready)"

‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤ backend logic ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ status 'ready' start ‡πÑ‡∏î‡πâ
‡∏ó‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà Work Queue design ‡πÉ‡∏´‡πâ 'ready' = ‡∏á‡∏≤‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö operator

‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà Agent ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥
	1.	‡∏´‡∏≤ logic ‡∏ó‡∏µ‡πà‡πÇ‡∏¢‡∏ô error ‡∏ô‡∏µ‡πâ
	‚Ä¢	‡∏Ñ‡πâ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° "Token not available (status:"
	‚Ä¢	‡∏Ñ‡∏ß‡∏£‡πÄ‡∏à‡∏≠ code ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì:

if ($token['status'] !== '...') {
    return $this->error("Token not available (status: {$token['status']})", 'DAG_400_START_FAILED');
}


	2.	‡∏Å‡∏≥‡∏´‡∏ô‡∏î allowed statuses ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô
	‚Ä¢	‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå spec ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡πá‡∏Å‡∏ï‡πå (‡∏´‡∏£‡∏∑‡∏≠ comment) ‡∏ß‡πà‡∏≤ start token ‡∏ñ‡∏π‡∏Å‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á
	‚Ä¢	‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏ß‡∏° 'ready' (‡∏ï‡∏≤‡∏° Work Queue UI)
	‚Ä¢	‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏∑‡πà‡∏ô ‡πÄ‡∏ä‡πà‡∏ô 'assigned' ‡∏´‡∏£‡∏∑‡∏≠ 'pending' ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏¢‡πÉ‡∏ä‡πâ start ‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡∏Ñ‡∏á logic ‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏ß‡πâ
‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á:

$allowedStatuses = ['ready']; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏≤‡∏° spec ‡πÄ‡∏î‡∏¥‡∏°

if (!in_array($token['status'], $allowedStatuses, true)) {
    return $this->error("Token not available (status: {$token['status']})", 'DAG_400_START_FAILED');
}


	3.	‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ú‡∏π‡∏Å‡∏Å‡∏±‡∏ö operator ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
	‚Ä¢	‡∏ñ‡πâ‡∏≤ design ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡πà‡∏≤ token ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á operator ‡∏Ñ‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ñ‡∏∂‡∏á‡∏à‡∏∞ start ‡πÑ‡∏î‡πâ:
	‚Ä¢	‡πÄ‡∏ä‡πá‡∏Ñ‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç:

if ($token['assigned_member_id'] !== $currentMemberId) {
     return $this->error("Token not available for this member", 'DAG_400_START_FAILED');
}


	‚Ä¢	‡πÅ‡∏ï‡πà‡∏´‡πâ‡∏≤‡∏°‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà token ‡∏ñ‡∏π‡∏Å auto-assign ‡πÉ‡∏´‡πâ member ‡∏ô‡∏µ‡πâ‡∏ú‡πà‡∏≤‡∏ô engine ‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏°‡πà

	4.	‡∏≠‡∏¢‡πà‡∏≤‡∏ä‡∏ô‡∏Å‡∏±‡∏ö Serial Enforcement / Availability
	‚Ä¢	Logic ‡∏Ç‡∏≠‡∏á Serial Gate (BLOCKER) ‡πÅ‡∏•‡∏∞ Operator Availability ‡∏≠‡∏¢‡∏π‡πà‡∏Ñ‡∏ô‡∏•‡∏∞‡∏ä‡∏±‡πâ‡∏ô
	‚Ä¢	‡∏ñ‡πâ‡∏≤ Serial Gate block ‚Üí error code / message ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà "Token not available (status: ...)"

Tests ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ (PHPUnit)

‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô test ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà:
	1.	testCanStartReadyTokenAssignedToCurrentMember()
	‚Ä¢	Arrange:
	‚Ä¢	‡∏™‡∏£‡πâ‡∏≤‡∏á token ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ 'ready'
	‚Ä¢	assign ‡πÉ‡∏´‡πâ member A
	‚Ä¢	Act:
	‚Ä¢	‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Start API ‡πÉ‡∏ô context ‡∏Ç‡∏≠‡∏á member A
	‚Ä¢	Assert:
	‚Ä¢	‡πÑ‡∏°‡πà‡∏°‡∏µ error DAG_400_START_FAILED
	‚Ä¢	token status ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏° flow (‡πÄ‡∏ä‡πà‡∏ô in_progress ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏Ñ‡∏µ‡∏¢‡∏á)
	2.	testCannotStartTokenWithInvalidStatus()
	‚Ä¢	‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏ä‡πà‡∏ô 'scrapped', 'completed' ‡∏Ø‡∏•‡∏Ø
	‚Ä¢	Expect: ‡∏¢‡∏±‡∏á‡πÑ‡∏î‡πâ DAG_400_START_FAILED ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
	3.	testCannotStartTokenAssignedToOtherMember() (‡∏ñ‡πâ‡∏≤ design ‡∏£‡∏∞‡∏ö‡∏∏)
	‚Ä¢	token ready ‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡∏≠‡∏á member B
	‚Ä¢	member A ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏° start ‚Üí error

‚∏ª

üîç Part B ‚Äì Restore ‚Äú‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‚Äù Content

‡∏õ‡∏±‡∏ç‡∏´‡∏≤
	‚Ä¢	‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏Ç‡∏≠‡∏á Work Queue ‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô ‚Äú‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‚Äù (‡∏ó‡∏±‡πâ‡∏á desktop / mobile)
	‚Ä¢	‡∏Å‡πà‡∏≠‡∏ô refactor ‡πÄ‡∏Ñ‡∏¢‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÄ‡∏ä‡πà‡∏ô:
	‚Ä¢	serial number
	‚Ä¢	job code / order number
	‚Ä¢	‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠‡∏¢ ‡∏´‡∏£‡∏∑‡∏≠ note
	‚Ä¢	‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡∏¥‡∏î dropdown ‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤ ‚Üí ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà JS/template ‡πÉ‡∏ä‡πâ‡∏´‡∏≤‡∏¢‡πÑ‡∏õ‡∏à‡∏≤‡∏Å JSON ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠ field

‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà Agent ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥
	1.	Inspect Frontend Template
	‚Ä¢	‡∏´‡∏≤ JS/View ‡∏Ç‡∏≠‡∏á work_queue:
	‚Ä¢	‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏ï‡∏≠‡∏ô render ‚Äú‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‚Äù ‡∏°‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å field ‡∏≠‡∏∞‡πÑ‡∏£‡∏à‡∏≤‡∏Å token object ‡πÄ‡∏ä‡πà‡∏ô:

token.details
token.serial_number
token.note
token.items


	‚Ä¢	‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ field ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏ß‡πà‡∏≤ UI ‡∏Ñ‡∏≤‡∏î‡∏´‡∏ß‡∏±‡∏á‡∏≠‡∏∞‡πÑ‡∏£‡∏ö‡πâ‡∏≤‡∏á

	2.	Inspect Work Queue API Response
	‚Ä¢	‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤ Work Queue ‡πÉ‡∏ô browser (dev mode)
	‚Ä¢	‡∏î‡∏π Network ‚Üí XHR / Fetch ‡∏ó‡∏µ‡πà‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô work_queue_api.php?action=list)
	‚Ä¢	‡∏î‡∏π payload JSON ‡∏à‡∏£‡∏¥‡∏á‡∏ß‡πà‡∏≤‡∏°‡∏µ field ‡∏ó‡∏µ‡πà UI ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
	‚Ä¢	‡∏ñ‡πâ‡∏≤ field ‡∏Ç‡∏≤‡∏î ‚Üí backend ‡πÑ‡∏°‡πà‡∏™‡πà‡∏á‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠
	‚Ä¢	‡∏ñ‡πâ‡∏≤ field ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‚Üí ‡∏ï‡πâ‡∏≠‡∏á map ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà UI ‡πÉ‡∏ä‡πâ
	3.	Patch Backend ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏£‡∏ö
	‚Ä¢	‡πÅ‡∏Å‡πâ service/controller ‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á list token ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Work Queue:
	‚Ä¢	‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£ join / select field ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á (order, serial, note, etc.)
	‚Ä¢	Map ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á field ‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏µ‡πà frontend ‡πÉ‡∏ä‡πâ
	‚Ä¢	‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á JSON ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
‚Üí ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ ‚Äú‡πÄ‡∏ï‡∏¥‡∏°‚Äù field ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£ restructure
	4.	‡πÑ‡∏°‡πà‡πÅ‡∏ï‡∏∞‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå / layout
	‚Ä¢	Template HTML ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á ‚Äú‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‚Äù ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô structure (‡πÄ‡∏ß‡πâ‡∏ô‡πÅ‡∏ï‡πà‡πÅ‡∏Ñ‡πà‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô {{ ... }} ‡∏´‡∏£‡∏∑‡∏≠ text node)
	‚Ä¢	‡∏´‡πâ‡∏≤‡∏°‡∏¢‡πâ‡∏≤‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏õ‡∏∏‡πà‡∏° ‚Äú‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‚Äù
	‚Ä¢	‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏•‡∏ö element ‡πÉ‡∏´‡∏ç‡πà ‡πÜ ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ layout ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô

Manual Verification

‡∏´‡∏•‡∏±‡∏á patch:
	1.	Reload Work Queue:
	‚Ä¢	‡πÄ‡∏•‡∏∑‡∏≠‡∏Å card ‡πÉ‡∏î card ‡∏´‡∏ô‡∏∂‡πà‡∏á
	‚Ä¢	‡∏Å‡∏î ‚Äú‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‚Äù
	‚Ä¢	‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô design ‡πÄ‡∏î‡∏¥‡∏° (‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ data ‡∏à‡∏£‡∏¥‡∏á)
	2.	‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á Kanban view ‡πÅ‡∏•‡∏∞ List view (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
	3.	‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ö‡∏ô mobile viewport:
	‚Ä¢	‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏¢‡∏±‡∏á‡πÅ‡∏™‡∏î‡∏á‡πÑ‡∏î‡πâ‡∏™‡∏ß‡∏¢‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô patch
	‚Ä¢	‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ï‡πâ card ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÉ‡∏ô screenshot reference

‚∏ª

‚úÖ Acceptance Criteria
	1.	Start Token Logic
	‚Ä¢	Token ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ 'ready' ‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å assign ‡πÉ‡∏´‡πâ member ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:
	‚Ä¢	‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏î ‚Äú‡πÄ‡∏£‡∏¥‡πà‡∏°‚Äù ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ Work Queue ‡πÑ‡∏î‡πâ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
	‚Ä¢	‡πÑ‡∏°‡πà‡∏Ç‡∏∂‡πâ‡∏ô error "Token not available (status: ready)" ‡∏≠‡∏µ‡∏Å
	‚Ä¢	Token ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£ start (scrapped, completed, ‡∏Ø‡∏•‡∏Ø) ‡∏¢‡∏±‡∏á‡∏ñ‡∏π‡∏Å block ‡∏î‡πâ‡∏ß‡∏¢ DAG_400_START_FAILED ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
	2.	Work Queue Details
	‚Ä¢	‡∏™‡πà‡∏ß‡∏ô ‚Äú‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‚Äù ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏á‡∏≤‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡∏õ‡∏Å‡∏ï‡∏¥:
	‚Ä¢	‡πÉ‡∏ä‡πâ field ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà UI ‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö
	‚Ä¢	‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
	‚Ä¢	‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ó‡∏±‡πâ‡∏á desktop ‡πÅ‡∏•‡∏∞ mobile view
	3.	UI Stable
	‚Ä¢	‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á layout / ‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πâ‡∏≤ Work Queue
	‚Ä¢	‡∏õ‡∏∏‡πà‡∏° / header / ‡∏Å‡∏≤‡∏£‡πå‡∏î ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡∏£‡∏π‡∏õ‡∏£‡πà‡∏≤‡∏á‡πÅ‡∏•‡∏∞‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏î‡∏¥‡∏° (‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á)
	4.	Tests
	‚Ä¢	PHPUnit ‡∏Ç‡∏≠‡∏á‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï test ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ú‡πà‡∏≤‡∏ô
	‚Ä¢	‡πÑ‡∏°‡πà‡∏°‡∏µ test ‡πÄ‡∏î‡∏¥‡∏°‡∏û‡∏±‡∏á‡∏à‡∏≤‡∏Å patch ‡∏ô‡∏µ‡πâ

‚∏ª

üìù Notes for Agent
	‚Ä¢	‡∏´‡πâ‡∏≤‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏∏‡πà‡∏á‡∏Å‡∏±‡∏ö logic SerialHealthService, Serial Enforcement, Operator Availability ‡πÄ‡∏ß‡πâ‡∏ô‡πÅ‡∏ï‡πà‡∏û‡∏ö bug ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Work Queue
	‚Ä¢	‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á Task 11 ‡∏Ñ‡∏∑‡∏≠:
	‚Ä¢	‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤ Work Queue ‚Äú‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏à‡∏£‡∏¥‡∏á‚Äù ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö operator
	‚Ä¢	‡∏Å‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ ‚Üí ‡∏á‡∏≤‡∏ô‡∏ß‡∏¥‡πà‡∏á‡∏ï‡∏≤‡∏° flow ‡∏õ‡∏Å‡∏ï‡∏¥
	‚Ä¢	‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏£‡∏ö
	‚Ä¢	‡πÉ‡∏´‡πâ log ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ñ‡πâ‡∏≤‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà spam log ‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ

---