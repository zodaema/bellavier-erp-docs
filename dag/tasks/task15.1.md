

# Task 15.1 — System Seed Decoupling (Phase 1: Discovery & Impact Map)

## Objective
Identify all database tables, API endpoints, and JavaScript modules that depend on:
- **unit_of_measure (UOM)**
- **work_center**

These two tables contain `is_system` and `locked` flags and must become **fully seed‑driven** instead of ID‑driven.

This task builds the foundation for Phase 2 and Phase 3:
- Phase 2 → Add `*_code` columns to the affected tables (non-breaking)
- Phase 3 → Migrate API/JS code to use `*_code` and remove ID dependencies

---

## Deliverables (Generated by AI Agent)
AI Agent must produce **4 files**:

### 1. `task15.1_db_impact_map.md`
List all tables that reference `work_center` or `unit_of_measure`.

For each table include:
- Table name  
- FK column  
- Schema definition snippet  
- Is it system‑critical?  
- Does it require `*_code` migration?

---

### 2. `task15.1_api_impact_map.md`
List all PHP files that reference these tables.  
For each file include:
- File path  
- Function name  
- Summary of how it uses the ID  
- READ / WRITE / JOIN classification  
- Whether migration to `*_code` is required

Must include:
- CRUD endpoints
- Helper classes
- Services
- Routers
- Legacy files (marked as legacy)

---

### 3. `task15.1_js_impact_map.md`
List all JavaScript files that:
- Pass IDs to API
- Use IDs in DOM/UI
- Use IDs in binding or selection

For each file include:
- File path  
- Function name  
- API endpoint called  
- Payload structure showing ID usage  
- Migration need: Yes/No

---

### 4. `task15.1_results.md`
A summary file:
- Scope summary  
- Total tables affected  
- Total PHP files affected  
- Total JS files affected  
- High‑risk hotspots  
- Recommended order for Phase 2  
- Risks & mitigations  

---

## Acceptance Criteria
- No refactoring in this task (Phase 1 is discovery-only)
- No schema changes yet
- No code changes yet
- Only mapping, scanning, and documentation
- Must be complete enough to proceed safely to Task 15.2

---

## Notes
This task explicitly does **NOT** modify:
- Routing logic
- Stock/Material modules
- MO/Job Ticket modules
- Component system

This is a pure discovery and documentation phase, required before decoupling the system seeds.
