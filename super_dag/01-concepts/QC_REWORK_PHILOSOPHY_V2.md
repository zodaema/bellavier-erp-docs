# Bellavier ERP â€” Finalized Rework Philosophy (QC â†’ RRM â†’ Component Node Model)

> **Last Updated:** 2024-12-04  
> **Status:** âœ… FINALIZED  
> **Authors:** Human + AI Collaboration  
> **Classification:** Master Reference for AI Agents & Developers

---

## ðŸ“Œ Scope

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DOCUMENT SCOPE                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  âœ… IN SCOPE:                                                   â”‚
â”‚     â€¢ Hatthasilpa Line à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ DAG / Work Queue                  â”‚
â”‚     â€¢ QC Nodes à¸—à¸µà¹ˆà¸œà¸¹à¸à¸à¸±à¸š Behavior: QC_SINGLE, QC_FINAL, etc.   â”‚
â”‚     â€¢ Parallel Component Workflow                               â”‚
â”‚                                                                 â”‚
â”‚  âŒ OUT OF SCOPE:                                               â”‚
â”‚     â€¢ Classic Line (PWA à¸ªà¹à¸à¸™à¹€à¸‰à¸¢ à¹†)                              â”‚
â”‚     â€¢ Simple linear workflows without components                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> âš ï¸ **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸:** à¸­à¸¢à¹ˆà¸²à¸™à¸³à¹à¸™à¸§à¸„à¸´à¸”à¸™à¸µà¹‰à¹„à¸›à¸›à¸™à¸à¸±à¸š Classic PWA à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ Linear Task Flow

---

## ðŸŽ¯ Executive Summary

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           QC REWORK V2: THE COMPONENT ANCHOR MODEL              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  âŒ OLD WAY (Legacy):                                           â”‚
â”‚     Graph â†’ fail_edge â†’ fixed rework path                       â”‚
â”‚     Problem: à¸à¸£à¸²à¸Ÿà¸£à¸, à¹„à¸¡à¹ˆà¸¢à¸·à¸”à¸«à¸¢à¸¸à¹ˆà¸™, à¹„à¸¡à¹ˆà¸•à¸£à¸‡à¸à¸±à¸šà¸„à¸§à¸²à¸¡à¹€à¸›à¹‡à¸™à¸ˆà¸£à¸´à¸‡           â”‚
â”‚                                                                 â”‚
â”‚  âœ… NEW WAY (V2):                                               â”‚
â”‚     QC Behavior â†’ Human picks target â†’ Route to node            â”‚
â”‚     Benefit: à¸à¸£à¸²à¸Ÿà¸ªà¸°à¸­à¸²à¸”, à¸¢à¸·à¸”à¸«à¸¢à¸¸à¹ˆà¸™, à¸•à¸£à¸‡à¸à¸±à¸šà¸‡à¸²à¸™à¸Šà¹ˆà¸²à¸‡à¸ˆà¸£à¸´à¸‡              â”‚
â”‚                                                                 â”‚
â”‚  ðŸ”‘ KEY INNOVATION: Component Node                              â”‚
â”‚     = Anchor à¸—à¸µà¹ˆà¸šà¸­à¸à¸§à¹ˆà¸² branch à¸™à¸µà¹‰à¸„à¸·à¸­ component à¸­à¸°à¹„à¸£              â”‚
â”‚     = à¸à¸²à¸™à¸ªà¸³à¸«à¸£à¸±à¸š rework target algorithm                        â”‚
â”‚     = à¸—à¸³à¹ƒà¸«à¹‰ RRM, Traceability, Parallel à¸—à¸³à¸‡à¸²à¸™à¸£à¹ˆà¸§à¸¡à¸à¸±à¸™à¹„à¸”à¹‰         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1ï¸âƒ£ à¸›à¸±à¸à¸«à¸²à¸«à¸¥à¸±à¸à¸‚à¸­à¸‡à¸£à¸°à¸šà¸š Rework à¹à¸šà¸šà¹€à¸à¹ˆà¸² (Legacy QC Flow)

à¸£à¸°à¸šà¸š ERP à¸—à¸±à¹ˆà¸§à¹„à¸›â€”including legacy à¸—à¸µà¹ˆà¹€à¸£à¸²à¸¡à¸µà¹€à¸”à¸´à¸¡â€”à¹ƒà¸Šà¹‰ Philosophy à¹à¸šà¸šà¸™à¸µà¹‰:

```
Graph = Owner of Rework Logic
QC Fail = Follow "fail_edge"
```

### à¸›à¸±à¸à¸«à¸²à¹ƒà¸™à¸šà¸£à¸´à¸šà¸— Hatthasilpa:

| à¸›à¸±à¸à¸«à¸² | à¹€à¸«à¸•à¸¸à¸œà¸¥ |
|-------|--------|
| **à¸à¸£à¸²à¸Ÿà¸ˆà¸°à¸£à¸à¸—à¸±à¸™à¸—à¸µ** | à¸•à¹‰à¸­à¸‡à¹‚à¸¢à¸‡ fail-edge à¹„à¸›à¸¢à¸±à¸‡à¸—à¸¸à¸ node à¸—à¸µà¹ˆà¸­à¸²à¸ˆà¸•à¹‰à¸­à¸‡ rework |
| **QC à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆà¹„à¸¡à¹ˆà¹„à¸”à¹‰à¹€à¸­à¸‡** | à¸™à¸±à¸à¸­à¸­à¸à¹à¸šà¸šà¸à¸£à¸²à¸Ÿà¸•à¹‰à¸­à¸‡à¸à¸³à¸«à¸™à¸” rework path à¹à¸—à¸™à¸„à¸™à¸•à¸£à¸§à¸ˆà¸‡à¸²à¸™ |
| **à¸„à¸§à¸²à¸¡à¸¢à¸·à¸”à¸«à¸¢à¸¸à¹ˆà¸™à¸•à¹ˆà¸³** | Defect à¸¡à¸µà¸«à¸¥à¸²à¸¢à¸£à¸¹à¸›à¹à¸šà¸š à¹à¸•à¹ˆà¸§à¸´à¸–à¸µà¸—à¸²à¸‡à¹à¸à¹‰à¸¡à¸µà¸¡à¸²à¸à¸à¸§à¹ˆà¸²à¸«à¸™à¸¶à¹ˆà¸‡à¹€à¸ªà¸¡à¸­ |
| **Real-life â‰  Graph** | à¸‡à¸²à¸™à¸Šà¹ˆà¸²à¸‡à¸ˆà¸£à¸´à¸‡à¸•à¹‰à¸­à¸‡ "à¸›à¸£à¸°à¹€à¸¡à¸´à¸™à¸Šà¸´à¹‰à¸™à¸‡à¸²à¸™" à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ follow automation |
| **Impact à¸‚à¸­à¸‡ parallel** | à¸Šà¸´à¹‰à¸™à¸ªà¹ˆà¸§à¸™à¹à¸•à¹ˆà¸¥à¸° component à¸¡à¸µ rework path à¸•à¹ˆà¸²à¸‡à¸à¸±à¸™ |

### à¸‚à¹‰à¸­à¸ªà¸£à¸¸à¸›:

> **QC à¹„à¸¡à¹ˆà¸„à¸§à¸£à¸–à¸¹à¸à¸„à¸§à¸šà¸„à¸¸à¸¡à¹‚à¸”à¸¢à¸à¸£à¸²à¸Ÿ à¹à¸•à¹ˆà¸•à¹‰à¸­à¸‡à¸„à¸§à¸šà¸„à¸¸à¸¡ "à¹‚à¸”à¸¢à¸œà¸¹à¹‰à¸•à¸£à¸§à¸ˆà¸‡à¸²à¸™à¸œà¹ˆà¸²à¸™ Behavior QC" à¹à¸—à¸™**

---

## 2ï¸âƒ£ QC V2 Philosophy: QC à¹€à¸›à¹‡à¸™à¸œà¸¹à¹‰à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆà¸§à¹ˆà¸² rework à¸à¸¥à¸±à¸šà¹„à¸› node à¹„à¸«à¸™

### à¹à¸™à¸§à¸„à¸´à¸”à¹ƒà¸«à¸¡à¹ˆà¸—à¸µà¹ˆà¸•à¸à¸œà¸¥à¸¶à¸:

1. **QC à¹€à¸›à¹‡à¸™ Human-judgment Node** â†’ à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ automated routing node
2. **à¹€à¸¡à¸·à¹ˆà¸­ QC à¸à¸” FAIL** â†’ à¹ƒà¸«à¹‰à¸£à¸°à¸šà¸šà¸–à¸²à¸¡à¸§à¹ˆà¸² "à¸ˆà¸°à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸šà¹„à¸› node à¹„à¸«à¸™?"
3. **à¸•à¸±à¸§à¹€à¸¥à¸·à¸­à¸ node** à¸¡à¸µà¸žà¸·à¹‰à¸™à¸à¸²à¸™à¸ˆà¸²à¸ "component" à¸—à¸µà¹ˆà¸à¸³à¸¥à¸±à¸‡à¸—à¸³à¸­à¸¢à¸¹à¹ˆ
4. **à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸¡à¸µ edge_condition** à¸«à¸£à¸·à¸­ fail_edge à¸ªà¸³à¸«à¸£à¸±à¸š QC à¸­à¸µà¸à¸•à¹ˆà¸­à¹„à¸›
5. **à¸à¸£à¸²à¸Ÿà¸ªà¸°à¸­à¸²à¸”à¸‚à¸¶à¹‰à¸™** à¸­à¸¢à¹ˆà¸²à¸‡à¸¡à¸²à¸

### à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡ UI:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           QC RESULT: âŒ FAIL                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  Defect: à¸‚à¸­à¸šà¸ªà¸²à¸¢à¹„à¸¡à¹ˆà¹€à¸£à¸µà¸¢à¸š                              â”‚
â”‚                                                     â”‚
â”‚  Return to Node:                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ â–¼ à¹€à¸¥à¸·à¸­à¸ node à¸—à¸µà¹ˆà¸ˆà¸°à¸ªà¹ˆà¸‡à¸à¸¥à¸±à¸š                    â”‚     â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚
â”‚  â”‚   â€¢ à¸‚à¸±à¸”à¸‚à¸­à¸šà¸ªà¸²à¸¢ (EDGE_STRAP)                 â”‚     â”‚
â”‚  â”‚   â€¢ à¸•à¸´à¸”à¸à¸²à¸§à¸ªà¸²à¸¢ (GLUE_STRAP)                 â”‚     â”‚
â”‚  â”‚   â€¢ à¹€à¸¢à¹‡à¸šà¸ªà¸²à¸¢ (STITCH_STRAP)                 â”‚     â”‚
â”‚  â”‚   â€¢ à¸•à¸±à¸”à¸ªà¸²à¸¢ (CUT_STRAP)                     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                     â”‚
â”‚  Mode: â—‹ à¸‹à¹ˆà¸­à¸¡à¸Šà¸´à¹‰à¸™à¹€à¸”à¸´à¸¡  â— à¸•à¸±à¸”à¹ƒà¸«à¸¡à¹ˆà¸—à¸±à¹‰à¸‡à¸Šà¸´à¹‰à¸™             â”‚
â”‚                                                     â”‚
â”‚  [à¸¢à¸·à¸™à¸¢à¸±à¸™à¸ªà¹ˆà¸‡à¸à¸¥à¸±à¸š]                                     â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸:** à¸£à¸°à¸šà¸šà¹„à¸¡à¹ˆà¹€à¸”à¸²à¸ªà¸¸à¹ˆà¸¡ - à¸•à¸±à¸§à¹€à¸¥à¸·à¸­à¸à¸¡à¸²à¸ˆà¸²à¸ algorithm à¸Šà¸±à¸”à¹€à¸ˆà¸™

---

## 3ï¸âƒ£ Algorithm: à¸£à¸°à¸šà¸š "à¸£à¸¹à¹‰à¹„à¸”à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£" à¸§à¹ˆà¸² Node à¹ƒà¸”à¹€à¸›à¹‡à¸™à¸•à¸±à¸§à¹€à¸¥à¸·à¸­à¸à¸ªà¸³à¸«à¸£à¸±à¸š Rework?

### à¸«à¸±à¸§à¹ƒà¸ˆà¸ªà¸³à¸„à¸±à¸:

> ðŸ”¥ **à¸£à¸°à¸šà¸šà¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰à¸Šà¸·à¹ˆà¸­ node, à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰ behavior, à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰ edge à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸š  
> à¹à¸•à¹ˆà¹ƒà¸Šà¹‰ "Component Anchor Model"**

---

## 4ï¸âƒ£ Component Anchor Model (à¸«à¸±à¸§à¹ƒà¸ˆà¸‚à¸­à¸‡ DAG Hatthasilpa)

### à¸›à¸±à¸à¸«à¸²à¹€à¸”à¸´à¸¡:

Parallel graph à¸¡à¸µà¸«à¸¥à¸²à¸¢ branch à¹à¸•à¹ˆà¸£à¸°à¸šà¸šà¹„à¸¡à¹ˆà¸£à¸¹à¹‰à¸§à¹ˆà¸² branch à¹„à¸«à¸™ = component à¸­à¸°à¹„à¸£

```
SPLIT
 â”œâ”€ ??? (BODY? FLAP? STRAP?)
 â”‚    â”œâ”€ à¹€à¸¢à¹‡à¸šà¸ªà¸²à¸¢
 â”‚    â”œâ”€ à¸•à¸´à¸”à¸à¸²à¸§à¸ªà¸²à¸¢
 â”‚    â””â”€ à¸•à¸±à¸”à¸ªà¹ˆà¸§à¸™à¸›à¸£à¸°à¸à¸­à¸šà¸•à¸£à¸‡à¸à¸¥à¸²à¸‡   â† à¸Šà¸·à¹ˆà¸­à¹„à¸¡à¹ˆà¸šà¸­à¸à¸§à¹ˆà¸²à¹€à¸›à¹‡à¸™ component à¸­à¸°à¹„à¸£!
 â””â”€ ???
      â”œâ”€ ...
```

### à¹à¸™à¸§à¸„à¸´à¸”à¸—à¸µà¹ˆà¸•à¸à¸œà¸¥à¸¶à¸:

à¹€à¸žà¸´à¹ˆà¸¡à¸›à¸£à¸°à¹€à¸ à¸— node à¹ƒà¸«à¸¡à¹ˆ:

### ðŸŸ¦ Component Node (New Node Type)

à¸—à¸³à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¹€à¸«à¸¡à¸·à¸­à¸™ **"Start node à¸‚à¸­à¸‡à¹à¸•à¹ˆà¸¥à¸° component"**:

```
SPLIT
 â”‚
 â”œâ”€ ðŸŸ¦ COMPONENT: STRAP
 â”‚    â”œâ”€ CUT_STRAP
 â”‚    â”œâ”€ GLUE_STRAP
 â”‚    â”œâ”€ EDGE_STRAP
 â”‚    â””â”€ QC_STRAP
 â”‚
 â””â”€ ðŸŸ¦ COMPONENT: BODY
      â”œâ”€ CUT_BODY
      â”œâ”€ STITCH_BODY
      â”œâ”€ EDGE_BODY
      â””â”€ QC_BODY
```

### Benefits:

| Feature | Explanation |
|---------|-------------|
| **à¸£à¸°à¸šà¸šà¸£à¸¹à¹‰à¸§à¹ˆà¸² branch à¸™à¸µà¹‰à¸„à¸·à¸­ component à¸­à¸°à¹„à¸£** | anchor node à¸šà¸­à¸à¸Šà¸±à¸”à¹€à¸ˆà¸™ |
| **Rework UI à¹à¸ªà¸”à¸‡à¹€à¸‰à¸žà¸²à¸° node à¹ƒà¸™ component à¸™à¸±à¹‰à¸™** | à¹€à¸žà¸£à¸²à¸°à¸‚à¸¶à¹‰à¸™à¸­à¸¢à¸¹à¹ˆà¸à¸±à¸š anchor |
| **Traceability à¹à¸ªà¸”à¸‡à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸à¸£à¸°à¹€à¸›à¹‹à¸²** | BODY / STRAP / FLAP à¹à¸šà¸šà¹€à¸›à¹‡à¸™ section |
| **Parallel token à¸ªà¸²à¸¡à¸²à¸£à¸– map à¹€à¸›à¹‡à¸™ component à¹„à¸”à¹‰** | component_code à¸–à¸¹à¸à¸à¸³à¸«à¸™à¸”à¸—à¸µà¹ˆ split |
| **RRM à¸—à¸³à¸‡à¸²à¸™à¹„à¸”à¹‰à¸‰à¸¥à¸²à¸”** | à¸ªà¸²à¸¡à¸²à¸£à¸–à¸šà¸­à¸à¹„à¸”à¹‰à¸§à¹ˆà¸²à¸›à¸±à¸à¸«à¸²à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ component à¹„à¸«à¸™ |

> **à¸™à¸µà¹ˆà¸„à¸·à¸­à¸Šà¸´à¹‰à¸™à¸ªà¹ˆà¸§à¸™à¸—à¸µà¹ˆà¸‚à¸²à¸”à¸«à¸²à¸¢à¹„à¸› à¹à¸¥à¸°à¹€à¸›à¹‡à¸™à¸—à¸²à¸‡à¸­à¸­à¸à¸‚à¸­à¸‡à¸—à¸¸à¸à¸›à¸±à¸à¸«à¸²**

---

## 5ï¸âƒ£ à¸à¸²à¸£à¸«à¸² "Rework Target Nodes" (Algorithm)

### à¹€à¸¡à¸·à¹ˆà¸­ QC FAIL:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              REWORK TARGET ALGORITHM                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Step 1: Find Component Anchor                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  à¸”à¸¹à¸§à¹ˆà¸² token à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ component à¹„à¸«à¸™                                â”‚
â”‚  â†’ à¹€à¸”à¸´à¸™à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸šà¸ˆà¸™à¹€à¸ˆà¸­ "Component Node Anchor"                    â”‚
â”‚                                                                 â”‚
â”‚  Step 2: Collect Downstream Nodes                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  à¸£à¸§à¸šà¸£à¸§à¸¡à¸—à¸¸à¸ Node à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ downstream à¸‚à¸­à¸‡ Component Node           â”‚
â”‚  (à¹ƒà¸™ branch à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™)                                           â”‚
â”‚  = Candidate Node List                                          â”‚
â”‚                                                                 â”‚
â”‚  Step 3: Filter Valid Rework Targets                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  Filter à¹€à¸‰à¸žà¸²à¸° Node à¸—à¸µà¹ˆà¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡à¸ªà¸³à¸«à¸£à¸±à¸š rework:                      â”‚
â”‚    âœ… behavior à¸›à¸£à¸°à¹€à¸ à¸—à¸Šà¹ˆà¸²à¸‡ (Stitch, Edge, Glue, Assemble)        â”‚
â”‚    âŒ exclude QC / START / MERGE / SPLIT                        â”‚
â”‚                                                                 â”‚
â”‚  Result: Dropdown options for QC UI                             â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Pseudocode:

```php
function getReworkTargetsForQC(int $qcNodeId, int $tokenId): array
{
    // Step 1: Find component anchor
    $componentAnchor = $this->findComponentAnchor($qcNodeId);
    
    // Step 2: Get all nodes downstream of anchor (same branch)
    $candidateNodes = $this->getNodesInComponent($componentAnchor);
    
    // Step 3: Filter valid rework targets
    $reworkTargets = [];
    foreach ($candidateNodes as $node) {
        if ($this->isValidReworkTarget($node)) {
            $reworkTargets[] = [
                'node_id' => $node['id_node'],
                'node_code' => $node['node_code'],
                'node_name' => $node['node_name'],
                'behavior_type' => $node['behavior_type']
            ];
        }
    }
    
    return $reworkTargets;
}

function isValidReworkTarget(array $node): bool
{
    $excludeTypes = ['start', 'end', 'split', 'merge', 'qc', 'router'];
    return !in_array($node['node_type'], $excludeTypes);
}
```

> **à¸£à¸°à¸šà¸šà¸‰à¸¥à¸²à¸” â†’ à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹ƒà¸«à¹‰ user à¹ƒà¸ªà¹ˆà¸„à¹ˆà¸²à¹€à¸­à¸‡  
> à¹à¸¥à¸°à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡ encode à¸­à¸°à¹„à¸£à¹ƒà¸™à¸Šà¸·à¹ˆà¸­ node à¹€à¸¥à¸¢**

### Safety Net: Manual Override + Logging

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         FALLBACK: WHEN ALGORITHM FINDS NO TARGETS               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  à¸–à¹‰à¸² getReworkTargetsForQC() à¸«à¸² target à¹„à¸¡à¹ˆà¹€à¸ˆà¸­à¹€à¸¥à¸¢:               â”‚
â”‚                                                                 â”‚
â”‚  1. ðŸ“ Log Warning                                              â”‚
â”‚     â†’ "No rework targets found for component {code}"            â”‚
â”‚     â†’ à¸£à¸°à¸šà¸¸ graph_id, node_id, component_code                    â”‚
â”‚     â†’ à¹à¸ˆà¹‰à¸‡ admin à¸§à¹ˆà¸² graph/config à¸­à¸²à¸ˆà¸œà¸´à¸”                         â”‚
â”‚                                                                 â”‚
â”‚  2. ðŸŽ›ï¸ Show Manual Override UI                                  â”‚
â”‚     â†’ à¹à¸ªà¸”à¸‡ dropdown à¹ƒà¸«à¹‰ QC à¹€à¸¥à¸·à¸­à¸ node à¹à¸šà¸š manual                â”‚
â”‚     â†’ à¸ˆà¸³à¸à¸±à¸”à¸•à¸±à¸§à¹€à¸¥à¸·à¸­à¸à¹€à¸‰à¸žà¸²à¸° nodes à¸ à¸²à¸¢à¹ƒà¸•à¹‰ component anchor à¹€à¸”à¸´à¸¡     â”‚
â”‚     â†’ âŒ à¸«à¹‰à¸²à¸¡à¹€à¸›à¸´à¸”à¸—à¸±à¹‰à¸‡à¸à¸£à¸²à¸Ÿà¹ƒà¸«à¹‰à¹€à¸¥à¸·à¸­à¸ (à¸­à¸±à¸™à¸•à¸£à¸²à¸¢!)                     â”‚
â”‚                                                                 â”‚
â”‚  3. ðŸ”’ Constraint                                                â”‚
â”‚     â†’ QC à¸•à¹‰à¸­à¸‡à¹€à¸¥à¸·à¸­à¸ node à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ branch à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™        â”‚
â”‚     â†’ à¸à¸±à¸™à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¸ªà¹ˆà¸‡à¸‡à¸²à¸™à¸«à¸¥à¸¸à¸” branch                                 â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6ï¸âƒ£ à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸žà¸±à¸™à¸˜à¹Œà¸à¸±à¸š RRM (Root Rework Mapping)

RRM à¹ƒà¸Šà¹‰ component model à¸•à¸±à¸§à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    RRM + COMPONENT MODEL                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  à¸£à¸¹à¹‰ defect                                                     â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚  à¹€à¸ˆà¸­à¸§à¹ˆà¸² defect à¸™à¸µà¹‰à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸š component à¹„à¸«à¸™                        â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚  Map à¹„à¸› candidate node list                                     â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚  Suggest node à¹‚à¸”à¸¢à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´                                       â”‚
â”‚  (à¹à¸•à¹ˆà¹ƒà¸«à¹‰à¸„à¸™à¹€à¸¥à¸·à¸­à¸ override à¹„à¸”à¹‰)                                    â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7ï¸âƒ£ à¸›à¸£à¸±à¸šà¸›à¸£à¸¸à¸‡ Graph Philosophy

### âŒ à¸ªà¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰à¸­à¸µà¸à¸•à¹ˆà¸­à¹„à¸› (à¸ªà¸³à¸«à¸£à¸±à¸š QC):

| âŒ DO NOT USE | à¹€à¸«à¸•à¸¸à¸œà¸¥ |
|--------------|--------|
| `edge_condition` à¸ªà¸³à¸«à¸£à¸±à¸š QC | à¸—à¸³à¹ƒà¸«à¹‰à¸à¸£à¸²à¸Ÿà¸£à¸ à¸‹à¸±à¸šà¸‹à¹‰à¸­à¸™ |
| `fail_edge` | à¹„à¸¡à¹ˆà¸ªà¸­à¸”à¸„à¸¥à¹‰à¸­à¸‡à¸à¸±à¸š reality |
| à¸¥à¸¹à¸›à¸à¸¥à¸±à¸šà¹ƒà¸™à¸à¸£à¸²à¸Ÿ | à¸¢à¸²à¸à¸•à¹ˆà¸­à¸à¸²à¸£ maintain |

### âœ… à¸ªà¸´à¹ˆà¸‡à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¹à¸—à¸™:

| âœ… USE | à¹€à¸«à¸•à¸¸à¸œà¸¥ |
|--------|--------|
| **QC Behavior à¹€à¸›à¹‡à¸™à¹€à¸ˆà¹‰à¸²à¸‚à¸­à¸‡ routing decision** | à¸¢à¸·à¸”à¸«à¸¢à¸¸à¹ˆà¸™ à¸•à¸£à¸‡à¸à¸±à¸šà¸‡à¸²à¸™à¸ˆà¸£à¸´à¸‡ |
| **Graph à¸ªà¸°à¸­à¸²à¸” à¹€à¸£à¸µà¸¢à¸šà¸‡à¹ˆà¸²à¸¢ à¸­à¹ˆà¸²à¸™à¸‡à¹ˆà¸²à¸¢** | maintain à¸‡à¹ˆà¸²à¸¢ |
| **Component model** | Rework à¸¡à¸µà¸„à¸§à¸²à¸¡à¸«à¸¡à¸²à¸¢à¹€à¸Šà¸´à¸‡à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡ |

### à¸à¸²à¸£à¹ƒà¸Šà¹‰ edge_condition (à¹à¸¢à¸à¸•à¸²à¸¡ Node Type):

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              EDGE CONDITION USAGE BY NODE TYPE                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   ROUTER / OPTION   â”‚     â”‚      QC NODE        â”‚           â”‚
â”‚  â”‚        NODE         â”‚     â”‚                     â”‚           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â”‚                     â”‚     â”‚                     â”‚           â”‚
â”‚  â”‚  âœ… USE edge_conditionâ”‚    â”‚  âŒ NO edge_conditionâ”‚          â”‚
â”‚  â”‚                     â”‚     â”‚                     â”‚           â”‚
â”‚  â”‚  â€¢ Auto-skip node   â”‚     â”‚  â€¢ Plain rework edgesâ”‚          â”‚
â”‚  â”‚  â€¢ Material routing â”‚     â”‚  â€¢ Human picks targetâ”‚          â”‚
â”‚  â”‚  â€¢ Option-based     â”‚     â”‚  â€¢ Behavior UI decidesâ”‚         â”‚
â”‚  â”‚                     â”‚     â”‚                     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                 â”‚
â”‚  Logic in Graph              Logic in Behavior                  â”‚
â”‚  System decides              Human decides                      â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8ï¸âƒ£ à¸ˆà¸¸à¸”à¹à¸‚à¹‡à¸‡à¸‚à¸­à¸‡à¹à¸™à¸§à¸„à¸´à¸”à¸™à¸µà¹‰ (à¹ƒà¸™à¸£à¸°à¸”à¸±à¸š Enterprise)

### 1. à¹€à¸›à¹‡à¸™à¸£à¸°à¸šà¸š QC à¹à¸šà¸š Luxury Brand à¸ˆà¸£à¸´à¸‡ à¹†

> HermÃ¨s, LV, Goyard à¹ƒà¸Šà¹‰ **Human QC â†’ Human decision**  
> à¹„à¸¡à¹ˆ automate QC routing

### 2. à¸à¸£à¸²à¸Ÿ maintain à¸‡à¹ˆà¸²à¸¢à¸‚à¸¶à¹‰à¸™ 100 à¹€à¸—à¹ˆà¸²

- Designer à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸§à¸²à¸”à¸¥à¸¹à¸à¸¨à¸£à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸š
- à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸ªà¸£à¹‰à¸²à¸‡ conditional edges

### 3. RRM à¸¡à¸µ logic à¸—à¸µà¹ˆà¹€à¸•à¸´à¸šà¹‚à¸•à¹„à¸”à¹‰à¹ƒà¸™à¸­à¸™à¸²à¸„à¸•

- à¸—à¸³ defect â†’ node mapping à¹à¸šà¸š AI à¹„à¸”à¹‰
- à¹€à¸žà¸£à¸²à¸°à¸¡à¸µ "component anchor" à¹€à¸›à¹‡à¸™à¸à¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡

### 4. Parallel workflow à¹ƒà¸Šà¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”

- split / merge / rework / traceability à¹ƒà¸Šà¹‰ `component_code` à¸£à¹ˆà¸§à¸¡à¸à¸±à¸™

### 5. à¸‚à¸¢à¸²à¸¢à¹„à¸›à¸—à¸³ BOM, material-level defect, skill metrics à¹„à¸”à¹‰à¸‡à¹ˆà¸²à¸¢

- à¹€à¸žà¸£à¸²à¸° component à¹€à¸›à¹‡à¸™ entity à¹€à¸Šà¸´à¸‡à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸ˆà¸£à¸´à¸‡

---

## 9ï¸âƒ£ Implementation Roadmap

### Phase 1: Component Node Type

#### Node Type Definition

| Property | Value | Description |
|----------|-------|-------------|
| `node_type` | `'component'` | à¸›à¸£à¸°à¹€à¸ à¸— node à¹ƒà¸«à¸¡à¹ˆ |
| `component_code` | `'BODY'`, `'STRAP'`, `'FLAP'`, etc. | à¸£à¸«à¸±à¸ª component |
| `work_center_id` | `NULL` | âŒ à¹„à¸¡à¹ˆà¸¡à¸µ work center |
| `behavior_code` | `NULL` | âŒ à¹„à¸¡à¹ˆà¸¡à¸µ behavior |
| `is_parallel_split` | `false` | à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ split node |
| `is_merge_node` | `false` | à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ merge node |

#### Purpose

- à¸£à¸°à¸šà¸¸ `component_code` (BODY / STRAP / FLAP / â€¦)
- à¹€à¸›à¹‡à¸™ anchor à¸ªà¸³à¸«à¸£à¸±à¸šà¸«à¸² nodes à¹ƒà¸™ branch à¸™à¸µà¹‰
- à¹„à¸¡à¹ˆà¸¡à¸µ work à¹€à¸à¸´à¸”à¸‚à¸¶à¹‰à¸™à¸—à¸µà¹ˆ node à¸™à¸µà¹‰ (token à¸œà¹ˆà¸²à¸™à¸—à¸±à¸™à¸—à¸µ)

#### Database Schema

```sql
-- Add component_code column
ALTER TABLE routing_node ADD COLUMN component_code VARCHAR(50) NULL;

-- New node_type enum value
-- node_type IN ('start', 'end', 'operation', 'qc', 'split', 'merge', 'router', 'component')
```

### Phase 2: getReworkTargets() Service

```php
// DAGRoutingService.php
public function getReworkTargetsForQC(int $qcNodeId, int $tokenId): array;
public function findComponentAnchor(int $nodeId): ?array;
public function getNodesInComponent(array $anchorNode): array;
```

### Phase 3: QC Behavior UI

```javascript
// qc_behavior.js
async function loadReworkTargets(qcNodeId, tokenId) {
    const resp = await fetch(`/source/dag_routing_api.php?action=get_rework_targets&qc_node_id=${qcNodeId}&token_id=${tokenId}`);
    renderReworkDropdown(resp.targets);
}
```

### Phase 4: Integrate with RRM

```php
// RRM suggests based on defect â†’ component mapping
public function suggestReworkTarget(int $defectTypeId, int $componentNodeId): ?int;
```

---

## ðŸ”Ÿ Quick Reference for AI Agents

### à¸ªà¸£à¸¸à¸›à¸ªà¸±à¹‰à¸™à¸—à¸µà¹ˆà¸ªà¸¸à¸”:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           INSTRUCTIONS FOR AI AGENTS                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. QC à¹„à¸¡à¹ˆà¸„à¸§à¸£à¹ƒà¸Šà¹‰ edge à¸«à¸£à¸·à¸­ edge_condition à¸­à¸µà¸à¸•à¹ˆà¸­à¹„à¸›              â”‚
â”‚                                                                 â”‚
â”‚  2. Rework decision à¸•à¹‰à¸­à¸‡à¸¡à¸²à¸ˆà¸²à¸ Behavior QC à¹‚à¸”à¸¢à¸•à¸£à¸‡               â”‚
â”‚                                                                 â”‚
â”‚  3. à¹€à¸¡à¸·à¹ˆà¸­ QC FAIL â†’ à¸£à¸°à¸šà¸šà¸–à¸²à¸¡à¸§à¹ˆà¸²à¸ˆà¸°à¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸šà¹„à¸› node à¹„à¸«à¸™             â”‚
â”‚                                                                 â”‚
â”‚  4. à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸«à¹‰à¸£à¸°à¸šà¸šà¸£à¸¹à¹‰à¸§à¹ˆà¸²à¸•à¸±à¸§à¹€à¸¥à¸·à¸­à¸ rework à¹€à¸›à¹‡à¸™ node à¹ƒà¸”              â”‚
â”‚     â†’ à¹€à¸£à¸²à¸•à¹‰à¸­à¸‡à¹€à¸žà¸´à¹ˆà¸¡ "Component Node" à¹ƒà¸™ Graph Designer          â”‚
â”‚                                                                 â”‚
â”‚  5. Component Node = anchor à¸‚à¸­à¸‡à¹à¸•à¹ˆà¸¥à¸° branch à¸‚à¸­à¸‡ parallel split â”‚
â”‚     â†’ à¸šà¸­à¸à¸£à¸°à¸šà¸šà¸§à¹ˆà¸²à¸ªà¸²à¸¢à¸™à¸µà¹‰à¸„à¸·à¸­ component à¸­à¸°à¹„à¸£ (BODY, STRAP, FLAP)    â”‚
â”‚                                                                 â”‚
â”‚  6. à¹€à¸¡à¸·à¹ˆà¸­ QC à¹€à¸à¸´à¸”à¸‚à¸¶à¹‰à¸™:                                          â”‚
â”‚     a) à¸£à¸°à¸šà¸šà¸«à¸² component anchor à¹ƒà¸à¸¥à¹‰à¸—à¸µà¹ˆà¸ªà¸¸à¸”                       â”‚
â”‚     b) à¸”à¸¶à¸‡à¸—à¸¸à¸ node à¹ƒà¸™ branch à¸™à¸±à¹‰à¸™à¹€à¸›à¹‡à¸™ candidate rework node     â”‚
â”‚     c) Filter à¹€à¸‰à¸žà¸²à¸° node à¸›à¸£à¸°à¹€à¸ à¸— operation                      â”‚
â”‚     d) à¹à¸ªà¸”à¸‡à¹ƒà¸«à¹‰ QC à¹€à¸¥à¸·à¸­à¸à¹ƒà¸™ dropdown                              â”‚
â”‚                                                                 â”‚
â”‚  7. à¸à¸£à¸²à¸Ÿà¹„à¸¡à¹ˆà¸ˆà¸³à¹€à¸›à¹‡à¸™à¸•à¹‰à¸­à¸‡à¸¡à¸µ fail-edge à¸«à¸£à¸·à¸­ conditional-edge        â”‚
â”‚     à¸ªà¸³à¸«à¸£à¸±à¸š QC à¸­à¸µà¸                                               â”‚
â”‚                                                                 â”‚
â”‚  8. Rework logic à¸¢à¹‰à¸²à¸¢à¹„à¸›à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ Behavior QC à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Related Documents

### Core Concepts
- [EDGE_CONDITION_USAGE_POLICY.md](./EDGE_CONDITION_USAGE_POLICY.md) - When to use edge_condition
- [COMPONENT_PARALLEL_FLOW.md](./COMPONENT_PARALLEL_FLOW.md) - Parallel flow design

### Specifications
- [BEHAVIOR_EXECUTION_SPEC.md](../02-specs/BEHAVIOR_EXECUTION_SPEC.md) - Behavior execution
- [FAILURE_RECOVERY_SERVICE_SPEC.md](../02-specs/FAILURE_RECOVERY_SERVICE_SPEC.md) - QC Fail Policy + Scrap/Replacement

### Services (à¹ƒà¸Šà¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ component_code à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™)
- `FailureRecoveryService` - Spawn replacement tokens, scrap handling
- `ComponentFlowService` - Parallel component tracking
- `DAGRoutingService` - getReworkTargetsForQC(), findComponentAnchor()

---

> **"QC = à¹‚à¸¥à¸à¸‚à¸­à¸‡à¸¡à¸™à¸¸à¸©à¸¢à¹Œà¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆ + à¸£à¸°à¸šà¸šà¸„à¸­à¸¢à¸à¸±à¸™à¸žà¸¥à¸²à¸”"**  
> **"Component Node = à¸«à¸±à¸§à¹ƒà¸ˆà¸—à¸µà¹ˆà¸‚à¸²à¸”à¸«à¸²à¸¢à¹„à¸›"**

